/*<<

 Title: Weekly 2014-07-21
 Date: 2014-07-21 10:09:26
 Tags: javascript
 Category: Weekly
 Sources:
   me: http://mpr0xy.com
>>*/


一开始是研究如何实现截取浏览器得屏幕，或者录制用户在浏览器里的操作过程．起点时看到一个网站[fullstory](https://www.fullstory.com/)提供这个功能，只需要在网页载入脚本即可．

然后在网上搜索，看到了一些项目．比如webrtc,其实更这个没什么关系，比较靠谱的时找到这个[html2canvas](https://github.com/niklasvh/html2canvas),可以把html转换为图片，而且时在客服端转换．接着发现了基于这个的一个引用，运行用户反馈时可以让用户选择网页得一部分，生成截图然后传回后端，叫[feedbackjs](https://github.com/niklasvh/feedback.js).后来研究覆盖层的时候，参考了[intro.js](http://usablica.github.io/intro.js/)

下面来重点了，看到feedbackjs里有让用户选择网页区域得代码，就想到了之前有道云比较提供的网页收藏功能，但是只能保存整页，或者标题，或者它自动识别的正文，不能自己选择．

那么我就想试一试如何实现自己选择元素，其实这个功能chrome的开发这工具审查元素就已经有了．一种实现的思路应该是：

* 监听鼠标移动事件
* 当鼠标在一个元素上时（不是上一个元素），计算这个元素的位置和长度，宽度．新建一个透明元素覆盖在上面．并记录鼠标当前在的元素为上一个元素．
* 获得这个鼠标所指元素的当前样式

###监听鼠标移动使用如下代码：
```
$( "body" ).mousemove(function( event ) {
    // some code
}
```

开发过程遇到一些问题，最后解决方案变成了以下步骤：

* 步骤１：当用户启动这个功能时，新建一个div层，覆盖到现在body上，这个div设置半透明，这样的效果就像时页面被盖住了，变暗了．
* 步骤２：完成上面这个步骤，用户移动鼠标，当鼠标在一个元素上时，会在这个元素上绘制上绘制一个高亮背景，然后把元素的z-index设置很高，是它显示到最外层，用户的感觉就是鼠标选中的元素到了步骤１中覆盖层的外面，高亮了．
* 步骤３：如果用户在鼠标选择一个元素后，点击鼠标，发送点击事件．那么这个元素会被再覆盖一层div，这个div阻止了鼠标再选择这个元素里面的元素，并且当鼠标在这个div上时，显示出close标示，点击close，会去掉这个元素的高亮．
* 步骤４：当不做步骤３，重复步骤２时，只有鼠标所指的当前元素会高亮
* 步骤５：当用户利用步骤３选中了一些高亮元素，就可以复制出(现在只是输出到console)这些元素，style属性里会带有元素当前的所有匹配的css


###demo
[http://cssdeck.com/labs/9extcodq](http://cssdeck.com/labs/9extcodq)

点击右下角的forge开始步骤１，再点击forge输出选中的元素，点击close关闭功能．
